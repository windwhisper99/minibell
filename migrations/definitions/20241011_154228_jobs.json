{"schemas":"--- original\n+++ modified\n@@ -12,6 +12,35 @@\n DEFINE FIELD OVERWRITE slots.*.jobs ON event TYPE array<record<job>> VALUE <set>($value);\n DEFINE FIELD OVERWRITE slots.*.jobs.* ON event TYPE record<job> ASSERT record::exists($value);\n\n+# -- Roles\n+DEFINE TABLE OVERWRITE job_role SCHEMAFULL;\n+DEFINE FIELD OVERWRITE name ON job_role TYPE string;\n+DEFINE FIELD OVERWRITE number ON job_role TYPE number;\n+\n+-- Sub Roles\n+DEFINE TABLE OVERWRITE job_sub_role SCHEMAFULL;\n+DEFINE FIELD OVERWRITE name ON job_sub_role TYPE string;\n+DEFINE FIELD OVERWRITE number ON job_sub_role TYPE number;\n+DEFINE FIELD OVERWRITE role ON job_sub_role TYPE record<job_role>;\n+\n+-- Jobs\n+DEFINE TABLE OVERWRITE job SCHEMAFULL;\n+DEFINE FIELD OVERWRITE name ON job TYPE string;\n+DEFINE FIELD OVERWRITE number ON job TYPE number;\n+DEFINE FIELD OVERWRITE sub_role ON job TYPE record<job_sub_role>;\n+\n+-- Role view\n+DEFINE TABLE OVERWRITE job_role_view TYPE NORMAL AS\n+SELECT *, id.id() as code,\n+    (\n+        SELECT *, id.id() as code,\n+            (\n+                SELECT *, id.id() as code\n+                FROM job WHERE sub_role = $parent.id ORDER BY number\n+            ) as jobs\n+        FROM job_sub_role WHERE role = $parent.id ORDER BY number\n+    ) as sub_roles\n+FROM job_role;\n DEFINE TABLE OVERWRITE script_migration SCHEMAFULL;\n\n DEFINE FIELD OVERWRITE script_name ON script_migration TYPE string;\n","events":null}