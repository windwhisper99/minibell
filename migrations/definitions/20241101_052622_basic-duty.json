{"schemas":"--- original\n+++ modified\n@@ -1,3 +1,39 @@\n+DEFINE TABLE OVERWRITE duty_category SCHEMAFULL;\n+DEFINE FIELD OVERWRITE name ON duty_category TYPE string;\n+\n+\n+DEFINE TABLE OVERWRITE duty SCHEMAFULL;\n+DEFINE FIELD OVERWRITE name ON duty TYPE string;\n+DEFINE FIELD OVERWRITE short_name ON duty TYPE option<string>;\n+DEFINE FIELD OVERWRITE image_url ON duty TYPE string;\n+DEFINE FIELD OVERWRITE sort ON duty TYPE number; -- This is a sort field for ordering the duties in the UI\n+DEFINE FIELD OVERWRITE category ON duty TYPE record<duty_category>;\n+\n+\n+DEFINE TABLE OVERWRITE duty_phase SCHEMAFULL;\n+DEFINE FIELD OVERWRITE duty ON duty_phase TYPE record<duty>;\n+DEFINE FIELD OVERWRITE name ON duty_phase TYPE string;\n+DEFINE FIELD OVERWRITE progression ON duty_phase TYPE number;\n+\n+\n+-- Duty view\n+DEFINE TABLE OVERWRITE duty_view TYPE NORMAL AS\n+SELECT *,\n+    (\n+        SELECT *\n+        FROM duty_phase WHERE duty = $parent.id\n+        ORDER BY progression\n+    ) as phases\n+FROM duty;\n+\n+DEFINE TABLE OVERWRITE duty_category_view TYPE NORMAL AS\n+SELECT *,\n+    (\n+        SELECT *\n+        FROM duty_view WHERE category = $parent.id\n+        ORDER BY sort\n+    ) as duties\n+FROM duty_category;\n -- \n -- Event schema\n DEFINE TABLE OVERWRITE event SCHEMAFULL;\n","events":null}